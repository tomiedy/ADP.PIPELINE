function Simpan(){var a=$("#nop").val(),b=$("#noktp").val(),c=$("#namaktp").val(),d=$("#alamatktp").val(),e=$("#tmplahir").val(),f=$("#tgllahir").val(),g=$("#rt").val(),h=$("#rw").val(),i=$("#kelurahan").val(),j=$("#kecamatan").val(),k=$("#alasan").val(),l=$("#keperluan").val(),m=$("#keterangan").val(),n=$("#masaPajak").val();$("#fileKtp").val(),$("#fileSkNonEKtp").val();$.ajax({url:"/SalinanSPPT/InsertSalinanSPPT",data:{nop:a,noKtp:b,namaKtp:c,alamatKtp:d,tmptLahir:e,tglLahir:f,rt:g,rw:h,kelurahanktp:i,kecamatanktp:j,ktp:targetResultKtp,skNonEktp:targetResultSkNonKtp,alasan:k,keperluan:l,keterangan:m,tahunPajak:n},type:"POST",dataType:"JSON",beforeSend:function(){$.blockUI({css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff"}})},complete:function(){$.unblockUI()},success:function(a){void 0!=a&&null!=a&&a.isRedirect&&(window.location.href=a.redirectUrl)}})}function readImage(a){if(a.files&&a.files[0])if(ValidateMaxFileSize(a)){var b=new FileReader;b.onload=function(a){$("#imgnonektp").attr("src",a.target.result),$("#anonektp").attr("href",a.target.result),targetResultSkNonKtp=a.target.result},b.readAsDataURL(a.files[0])}else OpenToastAutoMessage("Input File Tidak Boleh Melebihi 2Mb"),a.value=""}function readImageKTP(a){if(a.files&&a.files[0])if(ValidateMaxFileSize(a)){var b=new FileReader;b.onload=function(a){$("#imgktp").attr("src",a.target.result),$("#aktp").attr("href",a.target.result),targetResultKtp=a.target.result},b.readAsDataURL(a.files[0])}else OpenToastAutoMessage("Input File Tidak Boleh Melebihi 2Mb"),a.value=""}function ValidateMaxFileSize(a){for(var b=a.files[0].size,c=new Array("Bytes","KB","MB","GB"),d=0;b>900;)b/=1024,d++;var e=Math.round(100*b)/100+";"+c[d],f=e.split(";"),g=!0;switch(f[1]){case"KB":g=!0;break;case"MB":var h=parseInt(f[0]);h>2&&(g=!1);break;default:g=!1}return g||(a.value=""),g}var controlToValidate=[];$(document).ready(function(){controlToValidate.push($("#nop")),controlToValidate.push($("#noktp")),controlToValidate.push($("#masaPajak")),controlToValidate.push($("#keperluan")),controlToValidate.push($("#fileKtp")),$("#tgllahir").datepicker({changeMonth:!0,changeYear:!0,dateFormat:"dd/M/yy",numberOfMonths:1,autoclose:!0}),$("#tblTunggakan").hide(),$("#nop").mask("99.99.999.999.999.9999.9"),$("#filenonektp").hide(),$("#cbEktp").click(function(){$(this).is(":checked")?$("#filenonektp").show():$("#filenonektp").hide()});var a=!1,c="",d="";$("#btnSearchNop").click(function(b){$("#tblTunggakan").show(),b.preventDefault(),nop=$("#nop").val(),""==nop||null==nop?OpenToastAutoMessage("Nop harus diisi.."):($("#namawp").val(""),$("#alamatop").val(""),$("#alamatwp").val(""),$("#luasbumi").val(""),$("#luasbangunan").val(""),$.ajax({url:"/Permohonan/RetrieveDataObyek",data:{nop:nop},type:"POST",dataType:"JSON",beforeSend:function(){$.blockUI({css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff"}})},complete:function(){$.unblockUI()},success:function(b){if(null!=b&&void 0!=b)if(void 0!=b.DataObyek){if($("#namawp").val(b.DataObyek.NamaWP),$("#alamatop").val(b.DataObyek.AlamatOP),$("#alamatwp").val(b.DataObyek.AlamatWP),$("#luasbumi").val(b.DataObyek.LuasBumi),$("#luasbangunan").val(b.DataObyek.LuasBangunan),$("#masaPajak").empty(),$("#masaPajak2").empty(),0!=b.countListOp){var d='<option value="">--Pilih Tahun Pajak--</option>';$.each(b.listObyekPajak,function(a){d+='<option value="'+b.listObyekPajak[a].THN_PAJAK_SPPT+'">'+b.listObyekPajak[a].THN_PAJAK_SPPT+"</option>"}),$("#masaPajak").append(d),$("#masaPajak").change(function(){var a=$("#masaPajak").val();$("#masaPajak2").empty(),$.each(b.listObyekPajak,function(c){if(b.listObyekPajak[c].THN_PAJAK_SPPT>=a)var d='<option value="'+b.listObyekPajak[c].THN_PAJAK_SPPT+'">'+b.listObyekPajak[c].THN_PAJAK_SPPT+"</option>";$("#masaPajak2").append(d)})})}else if(0!=b.countListOpFasum){var d='<option value="">--Pilih Tahun--</option>';$.each(b.listObyekFasum,function(a){d+='<option value="'+b.listObyekFasum[a].THN_NIR_ZNT+'">'+b.listObyekFasum[a].THN_NIR_ZNT+"</option>"}),$("#masaPajak").append(d),$("#masaPajak").change(function(){var a=$("#masaPajak").val();$("#masaPajak2").empty(),$.each(b.listObyekFasum,function(c){if(b.listObyekFasum[c].THN_NIR_ZNT>=a)var d='<option value="'+b.listObyekFasum[c].THN_NIR_ZNT+'">'+b.listObyekFasum[c].THN_NIR_ZNT+"</option>";$("#masaPajak2").append(d)})})}else OpenToastAutoMessage(b.Message);b.isBlokir?(a=!0,errorToast(b.MessageBlokir),c=b.MessageBlokir,$("#TunggakanPBBByNopTableContainer").jtable("load",{nop:nop})):(a=!1,c="",$("#TunggakanPBBByNopTableContainer").jtable("load",{nop:nop}))}else OpenToastAutoMessage("Data Tidak Ditemukan")}}))}),$("#btnSearchKtp").click(function(a){a.preventDefault(),$("#namaktp").val(),$("#alamatktp").val(),$("#tgllahir").val(),$("#tmplahir").val(),$("#rt").val(),$("#rw").val(),$("#kelurahan").val(),$("#kecamatan").val();var b=$("#noktp").val();""==b||null==b?OpenToastAutoMessage("No. KTP harus diisi.."):$.ajax({url:"/Permohonan/GetWajibPajak",data:{noKTP:b},type:"POST",dataType:"json",beforeSend:function(){$.blockUI({css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff"}})},complete:function(){$.unblockUI()},success:function(a){void 0!=a&&null!=a&&($("#namaktp").val(a.Nama),$("#alamatktp").val(a.Alamat),$("#tgllahir").val(a.TanggalLahir),$("#tmplahir").val(a.TempatLahir),$("#rt").val(a.RT),$("#rw").val(a.RW),$("#kelurahan").val(a.Kelurahan),$("#kecamatan").val(a.Kecamatan),$("#frmKolDoku").find("input[type=text]").removeAttr("disabled"))},error:function(a){}})});var e=!1;$("#TunggakanPBBByNopTableContainer").jtable({title:"Data Tunggakan PBB",paging:!0,defaultSorting:"Name ASC",actions:{listAction:"/Permohonan/RetrieveDataTunggakanPBBByNOP"},fields:{NOP:{title:"NOP"},D_PJK_THN:{title:"TAHUN PAJAK"},StrJatuhTempo:{title:"Jatuh Tempo"},StrSisaPajak:{title:"Pokok Pajak"},StrDenda:{title:"Sanksi"},StrTotalTanggungan:{title:"Total"}},recordsLoaded:function(a,b){0!=b.serverResponse.TotalRecordCount?b.serverResponse.isDisabled?(e=!0,d=b.serverResponse.notifMsg):(e=!1,d=b.serverResponse.notifMsg):(e=!1,d="")}}),$("#saveSalinanSppt").click(function(){var b=IsControlTitleTextRequired(controlToValidate);if(b){var f=[];e&&f.push(d),a&&f.push(c)}f.length>0?errorToast(f):Simpan()})}),$("#fileSkNonEKtp").change(function(){readImage(this)});var targetResultSkNonKtp="";$("#fileKtp").change(function(){readImageKTP(this)});var targetResultKtp="";